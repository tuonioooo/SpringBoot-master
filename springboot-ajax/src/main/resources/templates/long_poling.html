<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" >
<head>
    <meta charset="UTF-8">
    <!--<meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">-->
    <meta http-equiv="expires" content="0">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="This is my page">
    <script src="http://libs.baidu.com/jquery/1.8.3/jquery.js"></script>
</head>
<body>
<div>
    <h1>AJAX长轮询</h1>
    <h2 id="h2Id"></h2>
</div>
<script type="text/javascript">
    /*function showPrice(index, data) {
        $("#c" + index).html("当前价格：" + data);
        var s = $("#s" + index).html();
        $("#s" + index).html(s + data +" ");
    }*/
    $(function(){
        if(!!window.EventSource){
            var source = new EventSource("needPrice");
            source.onmessage=function(evt){
                var dataObj = evt.data;
                var arr = dataObj.split(",");
                $.each(arr, function (i, item) {
                    alert(i + "=" + item);
                })
            };

            source.onopen=function(e){
                alert("Connecting server!")
                console.log("Connecting server!");
            };

            source.onerror=function () {
                console.log("error");
                alert("error")
            }
        }
    })


</script>
</body>

</html>